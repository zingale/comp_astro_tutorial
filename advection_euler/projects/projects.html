
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Practice Projects &#8212; Tutorial on Computational Astrophysics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/myfile.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Poisson problem" href="../../elliptic_multigrid/intro/elliptic-problems.html" />
    <link rel="prev" title="Second-order Euler solver" href="../euler/euler-solver.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/rt_small.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Tutorial on Computational Astrophysics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/floating-point/floating-point.html">
   Floating Point and Numerical Error
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/floating-point/numerical_error.html">
     Numerical Errors: Roundoff and Truncation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/diff-int/diff-int.html">
   Differentiation and Integration
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/diff-int/differentiation.html">
     Differentiation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/diff-int/integration.html">
     Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/diff-int/exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../basics/roots/root-finding.html">
   Root finding
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/ODEs/ODEs.html">
   Ordinary Differential Equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/ODEs/ODEs-partI.html">
     Basic Methods for ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/ODEs/ODEs-partII.html">
     Higher-order Accurate ODE Integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/ODEs/boundary-value-problems.html">
     Two Point Boundary Value Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/ODEs/exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../basics/linear-algebra/la-overview.html">
   Linear Algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../basics/linear-algebra/la-basics.html">
     Linear Algebra
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Advection and Hydrodynamics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advection/advection.html">
   Linear Advection Equation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/advection-partI.html">
     Linear Advection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/advection-partII.html">
     Finite-Volumes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/advection-partIII.html">
     Second-order advection
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../burgers/burgers.html">
   Burgers’ Equation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../burgers/burgers-methods.html">
     Burgers’ equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../burgers/exercises.html">
     Exercises
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../euler/euler.html">
   Euler Equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../euler/euler-eigen.html">
     Euler equations eigensystem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../euler/euler-riemann.html">
     Euler Riemann problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../euler/euler-riemann-sampling.html">
     Sampling the Riemann solution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../euler/euler-solver.html">
     Second-order Euler solver
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Practice Projects
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Elliptic Problems and Multigrid
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../elliptic_multigrid/intro/elliptic-problems.html">
   Poisson problem
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../elliptic_multigrid/relaxation/relaxation.html">
   Relaxation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../elliptic_multigrid/relaxation/elliptic-relaxation.html">
     Relaxation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../elliptic_multigrid/relaxation/elliptic-residual.html">
     Residual
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../elliptic_multigrid/relaxation/elliptic-modes.html">
     Behavior of Single Modes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../elliptic_multigrid/multigrid/multigrid.html">
   Multigrid
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../elliptic_multigrid/multigrid/multigrid-restrict-prolong.html">
     Restriction and Prolongation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../elliptic_multigrid/multigrid/multigrid-two-grid.html">
     Two Grid Correction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../elliptic_multigrid/multigrid/multigrid-vcycles.html">
     V-Cycles
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Stars
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../stars/stars.html">
   Stars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../stars/lane-emden.html">
   Lane-Emden polytrope equation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Integrating Stiff Reaction Networks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../reaction_networks/reactions.html">
   Nuclear Reactions
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../reaction_networks/stiff-ODEs.html">
   Integrating Stiff ODEs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../reaction_networks/ODEs-implicit.html">
     Implicit Methods for ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../reaction_networks/ODEs-implicit-systems.html">
     Implicit Methods for Systems of ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../reaction_networks/ODEs-implicit-nonlinear-systems.html">
     Implicit Methods and Nonlinear Systems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reaction_networks/integration-example.html">
   Integration Example
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/zingale/comp_astro_tutorial"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/zingale/comp_astro_tutorial/issues/new?title=Issue%20on%20page%20%2Fadvection_euler/projects/projects.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/advection_euler/projects/projects.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measuring-convergence-of-our-euler-solver">
   1. Measuring convergence of our Euler solver
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sedov-explosion-and-spherical-symmetry">
   2. Sedov explosion and spherical symmetry
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hll-riemann-solver">
   3. HLL Riemann solver
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#piecewise-parabolic-reconstruction-for-advection">
   4. Piecewise parabolic reconstruction for advection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-dimensional-advection">
   5. Two-dimensional advection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-conservation">
   6. Non-conservation?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explore-pyro">
   7. Explore pyro
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Practice Projects</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measuring-convergence-of-our-euler-solver">
   1. Measuring convergence of our Euler solver
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sedov-explosion-and-spherical-symmetry">
   2. Sedov explosion and spherical symmetry
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hll-riemann-solver">
   3. HLL Riemann solver
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#piecewise-parabolic-reconstruction-for-advection">
   4. Piecewise parabolic reconstruction for advection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#two-dimensional-advection">
   5. Two-dimensional advection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#non-conservation">
   6. Non-conservation?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explore-pyro">
   7. Explore pyro
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="practice-projects">
<h1>Practice Projects<a class="headerlink" href="#practice-projects" title="Permalink to this headline">#</a></h1>
<p>Here are some project ideas to help reinforce this material.</p>
<section id="measuring-convergence-of-our-euler-solver">
<h2>1. Measuring convergence of our Euler solver<a class="headerlink" href="#measuring-convergence-of-our-euler-solver" title="Permalink to this headline">#</a></h2>
<p>We measured convergence with advection by comparing to the exact
solution.  But what about the case when we don’t know the exact
solution?  We can use a grid convergence study to assess the
convergence.  Here’s how it works.</p>
<ol>
<li><p>Pick a smooth problem – a good problem is the acoustic pulse
described in this paper:</p>
<p><a class="reference external" href="https://msp.org/camcos/2011/6-1/p01.xhtml">A high-order
finite-volume method for conservation laws on locally refined
grids</a></p>
<p>See section 4.2.  You’ll do this in 1-d in our solver with periodic
BCs.</p>
</li>
<li><p>Run the problem at 4 different resolutions, each varying by a
factor of 2, e.g., 32, 64, 128, and 256 zones.</p></li>
<li><p>Compute an error between the run with N zones and the run with 2N
zones as follows:</p>
<ul>
<li><p>Coarsen the problem with 2N zones down to N zones by averaging
2 fine zones into a single coarse zone.  This is shown below:</p>
<p><img alt="restriction from a fine grid to a coarse grid" src="../../_images/fvrestrict.png" /></p>
<p>Here, <span class="math notranslate nohighlight">\(\phi^f\)</span> is a variable on the finer resolution grid and
<span class="math notranslate nohighlight">\(\phi^c\)</span> is the variable on the coarse grid.  We see that <span class="math notranslate nohighlight">\(\phi^c_j\)</span>
has two fine grid counterparts: <span class="math notranslate nohighlight">\(\phi^f_i\)</span> and <span class="math notranslate nohighlight">\(\phi^f_{i+1}\)</span>, so
we would do:</p>
<div class="math notranslate nohighlight">
\[\phi^c_j = \frac{1}{2} \left ( \phi^f_i + \phi^f_{i+1} \right )\]</div>
</li>
<li><p>Compute the <span class="math notranslate nohighlight">\(L_2\)</span>norm of the difference between the
coarsened 2N zone run and the N zone run.</p></li>
<li><p>Do this for all pairs, so for the 4 runs proposed above, you’d
have 3 errors corresponding to 64-128, 128-256, and 256-512.</p></li>
</ul>
</li>
<li><p>Plot the errors along with a line representing ideal 2nd order convergence.</p></li>
</ol>
<p>optional: try a different integrator, like 4th order Runge-Kutta and
see how that changes the convergence.</p>
</section>
<section id="sedov-explosion-and-spherical-symmetry">
<h2>2. Sedov explosion and spherical symmetry<a class="headerlink" href="#sedov-explosion-and-spherical-symmetry" title="Permalink to this headline">#</a></h2>
<p>We solved the equations of hydrodynamics in 1-d Cartesian coordinates.
If we want to model something that is spherically symmetric, we can do
1-d spherical coordinates.</p>
<p>In 1-d spherical coordinates, the equations of hydrodynamics are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
\frac{\partial \rho}{\partial t} + \frac{1}{r^2} \frac{\partial (r^2 \rho u)}{\partial r} &amp;= 0 \\
\frac{\partial (\rho u)}{\partial t} + \frac{1}{r^2} \frac{\partial (r^2 \rho u^2)}{\partial r} + \frac{\partial p}{\partial r} &amp;= 0 \\
\frac{\partial (\rho E)}{\partial t} + \frac{1}{r^2} \frac{\partial }{\partial r} \left [ r^2 (\rho E + p) u \right ] &amp;= 0
\end{align*}
\end{split}\]</div>
<p>The main difference is that the divergence has area and volume terms now.</p>
<p>A good problem to try with this is the Sedov blast wave explosion.  In
this problem, you put a lot of energy into a point at the center (the
origin of our spherical coordinates) and watch a spherical blast wave
move outward.  There is an analytic solution for a gamma-law gas that
can be compared to.</p>
<p>To solve this with the method-of-lines approach, we would need to:</p>
<ol>
<li><p>Add the <span class="math notranslate nohighlight">\(r\)</span> terms to the conservative update.</p></li>
<li><p>Implement reflecting boundary conditions at the origin of coordinates.</p>
<p>Reflecting boundary conditions mean that each zone in the ghost
cells has the same value as the corresponding zone in the interior
(e.g., same distance away from the boundary).  But for the
velocity, we switch the sign, such that the velocity moving toward
the interface will go to zero.</p>
<p>This would look like:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
      \rho_{\mathrm{lo}-1} &amp;= \rho_{\mathrm{lo}} \\
      \rho_{\mathrm{lo}-2} &amp;= \rho_{\mathrm{lo+1}} \\
   \end{align*}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
      (\rho u)_{\mathrm{lo}-1} &amp;= -(\rho u)_{\mathrm{lo}} \\
      (\rho u)_{\mathrm{lo}-2} &amp;= -(\rho u)_{\mathrm{lo+1}} \\
   \end{align*}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
      (\rho E)_{\mathrm{lo}-1} &amp;= (\rho E)_{\mathrm{lo}} \\
      (\rho E)_{\mathrm{lo}-2} &amp;= (\rho E)_{\mathrm{lo+1}} \\
   \end{align*}\end{split}\]</div>
</li>
<li><p>Setup the Sedov problem (I give a common implementation of the initial conditions below)
and run and compare to the exact solution.</p>
<p>For the initial conditions, it is common to specify an initial radius of the explosion, <span class="math notranslate nohighlight">\(r_0\)</span>.  Then
initialize the pressure as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p = \left \{ \begin{array}{cc} p_\mathrm{expl} &amp; r \le r_0 \\
                                    p_\mathrm{ambient} &amp; r &gt; r_0 \end{array} \right . \end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[p_\mathrm{ambient} = 10^{-5}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[p_\mathrm{expl} = (\gamma -1) \frac{E_\mathrm{Sedov}}{(4/3) \pi r_0^3}\]</div>
<p>and <span class="math notranslate nohighlight">\(E_\mathrm{Sedov} = 1\)</span> is the initial explosion energy.  This
formulation finds the pressure corresponding to spreading that
energy over a sphere of radius <span class="math notranslate nohighlight">\(r_0\)</span>.</p>
<p>The initial velocity is set to 0.0.</p>
<p>The density everywhere is 1.0.</p>
<p>Here’s the analytic solution for a case with <span class="math notranslate nohighlight">\(\gamma = 1.4\)</span>:
<a class="reference download internal" download="" href="../../_downloads/a69927700caa51c4e692f453aa2a2cc8/spherical_sedov.txt"><code class="xref download docutils literal notranslate"><span class="pre">spherical_sedov.txt</span></code></a></p>
</li>
</ol>
</section>
<section id="hll-riemann-solver">
<h2>3. HLL Riemann solver<a class="headerlink" href="#hll-riemann-solver" title="Permalink to this headline">#</a></h2>
<p>We solved the Riemann problem for the Euler equations exactly, but
many times in practice we use approximate Riemann solvers.  The HLL
solver is a popular solver.  Research this method and implement it in
the Euler code and compare the solutions you get with it to those with
the exact solver.</p>
</section>
<section id="piecewise-parabolic-reconstruction-for-advection">
<h2>4. Piecewise parabolic reconstruction for advection<a class="headerlink" href="#piecewise-parabolic-reconstruction-for-advection" title="Permalink to this headline">#</a></h2>
<p>In class, we considered piecewise constant and piecewise linear
reconstruction with advection.  The next step is piecewise parabolic
reconstruction.  This is described originally here:</p>
<p><a class="reference external" href="https://crd.lbl.gov/assets/pubs_presos/AMCS/ANAG/A141984.pdf">The Piecewise Parabolic Method (PPM) for Gas-Dynamical Systems</a></p>
<p>We want to try this with our method-of-lines integration scheme, which
considerably simplifies things compared to that original paper.</p>
<p>Here’s an example of piecewise parabolic reconstruction of data in each zone:</p>
<p><img alt="ppm" src="../../_images/piecewise-parabolic.png" /></p>
<p>As with piecewise linear, we will need to limit the parabola to
prevent overshoots.  The dotted lines in the figure above are
unlimited parabolas and the solid lines are the limited parabola.</p>
<p>The basic idea is as follows:</p>
<ol>
<li><p>In each zone, we construct a parabola, given by CW Eq. 1.4.  The CW
paper uses <span class="math notranslate nohighlight">\(\xi\)</span> as the space coordinate, were <span class="math notranslate nohighlight">\(\xi_i\)</span> is a zone
center and <span class="math notranslate nohighlight">\(\xi_{i-1/2}\)</span> and <span class="math notranslate nohighlight">\(\xi_{i+1/2}\)</span> are the left and right
edges.  It also allows for a non-uniformly spaced grid.</p>
<p>The parabola has the form:</p>
<div class="math notranslate nohighlight">
\[a(\xi) = a_{L,i} + x [ \Delta a_i + a_{6,i} (1 - x) ]\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[x = \frac{\xi - \xi_{i-1/2}}{\Delta \xi}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\Delta a_i = a_{R,i} - a_{L,i}\]</div>
<div class="math notranslate nohighlight">
\[a_{6,i} = 6 \left [ a_i - \frac{1}{2} (a_{L,i} + a_{R,i}) \right ]\]</div>
<p>Eqs. 1.5 through 1.10 give the method for computing the 3
coefficients of the parabola for each cell as well as limiting them
so as to not introduce any new extrema.</p>
<p>For a uniform grid, the steps are:</p>
<ul>
<li><p>Find the first guess at the interface values:</p>
<div class="math notranslate nohighlight">
\[a_{i+1/2} = \frac{1}{2} (a_i + a_{i+1}) + \frac{1}{6} (\delta a_i - \delta a_{i+1} )\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[\begin{split}\delta a_i = \left \{ \begin{array}{cc}
              \min\left (\frac{1}{2}|a_{i+1} - a_{i-1}|, 2 |a_{i+1} - a_i|, 2 |a_i - a_{i-1}|\right )
               \mathrm{sign}(a_{i+1} - a_{i-1})  &amp; \mbox{if}\ (a_{i+1} - a_i)(a_i - a_{i-1}) &gt; 0  \\
              0 &amp; \mbox{otherwise} \end{array} \right .\end{split}\]</div>
</li>
<li><p>Next, for zone <span class="math notranslate nohighlight">\(i\)</span>, set the left and right interface values using the above:</p>
<div class="math notranslate nohighlight">
\[a_{L,i} = a_{i-1/2}\]</div>
<div class="math notranslate nohighlight">
\[a_{R,i} = a_{i+1/2}\]</div>
</li>
<li><p>Now limit the data according to Eq. 1.10.</p></li>
</ul>
<p>Note: you’ll need 3 ghost cells in order to compute all of the information needed.</p>
</li>
<li><p>For the method-of-lines scheme we are using, we simply evaluate the parabola
on each interface and this gives that’s zones edge state.    For a parabolic reconstruction
in zone <span class="math notranslate nohighlight">\(i\)</span> of the form <span class="math notranslate nohighlight">\(a(\xi)\)</span>, our interface states are:</p>
<div class="math notranslate nohighlight">
\[a_{i-1/2,R} = a(\xi_{i-1/2}) = a_{L,i}\]</div>
<div class="math notranslate nohighlight">
\[a_{i+1/2,L} = a(\xi_{i+1/2}) = a_{R,i}\]</div>
</li>
<li><p>Compare the solution you get with PPM for the Sod problem to the
one we got with piecewise linear slopes.</p></li>
</ol>
</section>
<section id="two-dimensional-advection">
<h2>5. Two-dimensional advection<a class="headerlink" href="#two-dimensional-advection" title="Permalink to this headline">#</a></h2>
<p>The linear advection equation in 2-d is:</p>
<div class="math notranslate nohighlight">
\[a_t + u a_x + v a_y = 0\]</div>
<p>In conservative form, we’d write this as:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial a}{\partial t} + \frac{\partial (u a)}{\partial x} + \frac{\partial (v a)}{\partial y} = 0\]</div>
<p>We can develop a finite volume method by defining an average as:</p>
<div class="math notranslate nohighlight">
\[\langle a \rangle_{i,j} = \frac{1}{\Delta x \Delta y} \int_{x_{i-1/2}}^{x_{i+1/2}} \int_{y_{j-1/2}}^{y_{j+1/2}} a(x, y) dx dy\]</div>
<p>and our final update would look like (dropping the <span class="math notranslate nohighlight">\(\langle \rangle\)</span>):</p>
<div class="math notranslate nohighlight">
\[\frac{\partial}{\partial t} a_{i,j} = - \frac{1}{\Delta x} (F^{(x)}_{i+1/2,j} - F^{(x)}_{i-1/2,j}) - \frac{1}{\Delta y} (F^{(y)}_{i,j+1/2} - F^{(y)}_{i,j-1/2})\]</div>
<p>where <span class="math notranslate nohighlight">\(F^{(x)} = u a\)</span> and <span class="math notranslate nohighlight">\(F^{(y)} = v a\)</span>.</p>
<p>This can be solved using the same method-of-lines technique we did in
1-d, but now we need to create and manage a 2-d grid, fill ghost cells
on both <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> boundaries, and compute fluxes through both <span class="math notranslate nohighlight">\(x\)</span>
and <span class="math notranslate nohighlight">\(y\)</span> interfaces.</p>
<p><img alt="an example 2-d grid showing the interface states" src="../../_images/2dgrid.png" /></p>
<p>The flux computations are done simply by
reconstructing in one coordinate direction and solving the Riemann
problem in that direction.</p>
<p>Code up a 2-d advection solver and test it on advecting a Gaussian.</p>
<p>The timestep limiter needs to be adapted a bit, and is now:</p>
<div class="math notranslate nohighlight">
\[\Delta t = C \left [ \frac{u}{\Delta x} + \frac{v}{\Delta y} \right ]^{-1}\]</div>
</section>
<section id="non-conservation">
<h2>6. Non-conservation?<a class="headerlink" href="#non-conservation" title="Permalink to this headline">#</a></h2>
<p>Suppose instead of solving the total energy equation in the Euler
solver, you instead discretized the internal energy evolution
equation:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial (\rho e)}{\partial t} + \frac{\partial (\rho e u)}{\partial x} + p \frac{\partial u}{\partial x} = 0\]</div>
<p>You can compute the flux and the <span class="math notranslate nohighlight">\(p \partial u/\partial x\)</span> term using the solution from the Riemann problem as:</p>
<div class="math notranslate nohighlight">
\[p_i \frac{u_{i+1/2} - u_{i-1/2}}{\Delta x}\]</div>
<p>Note that the pressure here is the cell-center (average) pressure.</p>
<p>Code this up and run the Sod problem – how well do you agree with the exact solution?</p>
</section>
<section id="explore-pyro">
<h2>7. Explore pyro<a class="headerlink" href="#explore-pyro" title="Permalink to this headline">#</a></h2>
<p>Look at the python hydro solver pyro:</p>
<p><a class="reference external" href="https://pyro2.readthedocs.io/en/latest/">https://pyro2.readthedocs.io/en/latest/</a></p>
<p>Look at the list of solvers and work on running it and exploring the
problems that it provides.  Then add a problem to the solver, based on
something you find in the literature.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./advection_euler/projects"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../euler/euler-solver.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Second-order Euler solver</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../elliptic_multigrid/intro/elliptic-problems.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Poisson problem</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://zingale.github.io">Michael Zingale</a><br/>
  
    <div class="extra_footer">
      <p>
&copy; 2021-2022; CC-BY-NC-SA 4.0
<p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>